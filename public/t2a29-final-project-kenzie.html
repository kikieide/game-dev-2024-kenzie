<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    height: 100%;
    font-family: Arial, sans-serif;
}
    #myBody {
    background-image: url('https://github.com/kikieide/game-dev-2024-kenzie/blob/main/public/Screenshot%202025-01-02%20193735.png');
    background-repeat: repeat;
    background-size: 80%;
}
.myUi {
    position: absolute;
    top: 0; 
    left: 50%; 
    display: inline-table;
    text-align: right;
    border: 5px solid #9494b8;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    padding: 20px;
    width: fit-content;
}
   </style>
   
<script>
  window.onload = function() {
    myWaveStart();
  }

  // Global variables
  let randomIndex = Math.floor(Math.random() * 10);
  let myGlobalX = 0;
  let myClock;
  let myScore = 10;
  let myGun01;
  let myGun02;
  let myShooting = 1;
  let myEnemies = [];
  let myWave = 1;
  let myHits = 0;
  let enemyCount = 2;
  let enemyImages = [
    'https://piskel-imgstore-b.appspot.com/img/4a9339b0-c8c2-11ef-9a62-b92f8635db06.gif',
    'https://piskel-imgstore-b.appspot.com/img/0310e9a8-c8c3-11ef-8588-b92f8635db06.gif',
    'https://piskel-imgstore-b.appspot.com/img/e8a98414-c8c3-11ef-8f6f-b92f8635db06.gif'
  ];
 function myHitOther(obj1Id, obj2Id) {
    let obj1 = document.getElementById(obj1Id);
    let obj2 = document.getElementById(obj2Id);

    let left1 = parseInt(obj1.style.left);
    let right1 = left1 + parseInt(obj1.style.width);
    let top1 = parseInt(obj1.style.top);
    let bottom1 = top1 + parseInt(obj1.style.height);

    let left2 = parseInt(obj2.style.left);
    let right2 = left2 + parseInt(obj2.style.width);
    let top2 = parseInt(obj2.style.top);
    let bottom2 = top2 + parseInt(obj2.style.height);

    return !(right1 < left2 || left1 > right2 || bottom1 < top2 || top1 > bottom2);
  }

function myCheckHit() {
  // Update the score display
  document.all.myText01.value = myScore;

  // Check if the player hits any enemies
  if (myHitOther('myImg01', 'myImg02')) {
    document.getElementById('myImg01').style.left = '20px';
    document.all.myText01.value = 'You hit myImg02';
    myScore -= 1;
    myHits += 1;  // Increase hit counter
  }

  if (myHitOther('myImg01', 'myImg03')) {
    document.getElementById('myImg01').style.left = '20px';
    document.all.myText01.value = 'You hit myImg03';
    myScore -= 1;
    myHits += 1;  // Increase hit counter
  }

  // Check if the player's bullets hit any enemies
  if (myHitOther('myBullet01', 'myImg04')) {
    clearInterval(myGun01);
    document.getElementById('myBullet01').style.left = '-200px';
    document.all.myText01.value = 'You shot myImg04';
    myScore += 1;
    myHits += 1;  // Increase hit counter
  }

  if (myHitOther('myBullet01', 'myImg02')) {
    clearInterval(myGun01);
    document.getElementById('myBullet01').style.left = '-200px';
    document.all.myText01.value = 'You shot myImg02';
    myScore += 1;
    myHits += 1;  // Increase hit counter
  }

  if (myHitOther('myBullet02', 'myImg03')) {
    clearInterval(myGun02);
    document.getElementById('myBullet02').style.left = '-200px';
    document.all.myText01.value = 'You shot myImg03';
    myScore += 1;
    myHits += 1;  // Increase hit counter
  }


  if (myScore <= 0) {
    document.all.myText01.value = 'You Lose, score at zero!';
    alert('Sorry, you lose');
    location.reload();  
  }
}


function checkWaveProgression() {
  if (myHits >= myWave * 3) {
    myNewWave01();  
  }
}

function myEnemySpawn(xPosition, yPosition) {
  if (myEnemies.length >= 3) {
    let oldestEnemy = myEnemies.shift();
    document.body.removeChild(oldestEnemy);  // Remove the oldest enemy from the screen
  }

  // Create a new enemy and set its properties
  let newEnemy = document.createElement('img');
  newEnemy.src = enemyImages[Math.floor(Math.random() * enemyImages.length)];
  newEnemy.style.position = 'absolute';
  newEnemy.style.left = `${xPosition}px`;
  newEnemy.style.top = `${yPosition}px`;
  newEnemy.style.width = '140px';
  newEnemy.style.height = '130px';
  newEnemy.id = `myImg0${enemyCount}_${randomIndex + 1}`;
  enemyCount++;

  myEnemies.push(newEnemy);
  document.body.appendChild(newEnemy);
}

// Function to start a new wave of enemies
function myWaveStart() {
  let myRequiredHits = myWave * 3;  // The number of enemies to spawn based on the current wave
  for (let i = 0; i < myRequiredHits; i++) {
    let myXPosition = Math.random() * window.innerWidth;
    let myYPosition = Math.random() * window.innerHeight;
    myEnemySpawn(myXPosition, myYPosition);
  }
}

// Function to progress to the next wave
function myNewWave01() {
  if (myHits >= myWave * 3) {  // Ensure that 3 enemies are hit before progressing
    if (myWave < 4) {  // Limit the waves to 3
      switch (myWave) {
        case 1:
          myEnemyReset();
          setInterval(() => myEnemySpawn(100, 100), 2000);  // Spawn enemies with different speeds
          document.all.myText01.value = `Wave ${myWave}: Easy enemies!`;
          break;
        case 2:
          myEnemyReset();
          setInterval(() => myEnemySpawn(150, 150), 1500);
          document.all.myText01.value = `Wave ${myWave}: Faster enemies!`;
          break;
        case 3:
          myEnemyReset();
          setInterval(() => myEnemySpawn(200, 200), 1000);
          document.all.myText01.value = `Wave ${myWave}: Very fast enemies!`;
          break;
      }
      myWave++;  // Increase the wave count after it progresses
    } else {
      document.all.myText01.value = 'Maximum waves reached! You won the game!';
      alert('Maximum waves reached! You win!');
    }
  }
}

// Function to reset the enemies when a new wave starts
function myEnemyReset() {
  for (let i = 0; i < myEnemies.length; i++) {
    let enemy = myEnemies[i];
    document.body.removeChild(enemy);  // Remove enemies from the screen
  }
  myEnemies = [];  // Clear the array of enemies
}
</script>



<body id="myBody" style="background-image: url('https://github.com/kikieide/game-dev-2024-kenzie/blob/main/public/Screenshot%202025-01-02%20193735.png?raw=true'); background-repeat:repeat;" onkeydown="{
   document.all.myText01.value = event.key;

   if (event.key == 'd') { 
     document.getElementById('myImg01').style.left = parseInt(document.getElementById('myImg01').style.left) + 10 + 'px';
   }

   if (event.key == 's') {   
     document.getElementById('myImg01').style.top = parseInt(document.getElementById('myImg01').style.top) + 10 + 'px';
   }

   if (event.key == 'w') {  
     document.getElementById('myImg01').style.top = parseInt(document.getElementById('myImg01').style.top) - 10 + 'px';
   }

   if (event.key == 'a') {   
     document.getElementById('myImg01').style.left = parseInt(document.getElementById('myImg01').style.left) - 10 + 'px';
   }

   myCheckHit();  // Check for collisions
}">
    
    <script>
  class Wall {
  constructor(x, y, width, height, src) {
    this.x = x;
    this.y = y; 
    this.width = width; 
    this.height = height; 
    this.element = document.createElement('img');
    this.element.src = src; 
    this.element.style.position = 'absolute'; 
    this.element.style.left = `${x}px`; 
    this.element.style.top = `${y}px`;
    this.element.style.width = `${width}px`; 
    this.element.style.height = `${height}px`; 
    document.body.appendChild(this.element); 
  }

  // Function to check if the wall is colliding with the player
  isCollidingWith(player) {
    // Get the player's position and size
    let playerX = parseInt(player.style.left, 10);
    let playerY = parseInt(player.style.top, 10);
    let playerWidth = parseInt(player.style.width, 10);
    let playerHeight = parseInt(player.style.height, 10);

    // Check if the player and the wall overlap (collision check)
    return !(this.x + this.width < playerX || 
             this.x > playerX + playerWidth ||
             this.y + this.height < playerY || 
             this.y > playerY + playerHeight);
  }
}

let wall1 = new Wall(200, 200, 590, 350, 'https://piskel-imgstore-b.appspot.com/img/2421f817-ca66-11ef-8399-919e8c66eff8.gif');
let wall2 = new Wall(1500, 500, 590, 350, 'https://piskel-imgstore-b.appspot.com/img/2421f817-ca66-11ef-8399-919e8c66eff8.gif');
</script>
  
        
<div id="myUi" class="myUi">
    <h2>Wave 1: <span id="waveEnemiesLeft">5</span> Left</h2>
    <progress id="waveBar" value="0" max="5"></progress>
    <b style= "color: white">Level 1 based on the template. Use buttons or WASD to move. Shoot 3 enemies before to clear the waves.</b>
<input id="myText01" type=text style="font-atyle: bold" value="" size=50 placeholder="Feedback here"><br>  
    
    <input type=button value="Auto Background Left" onclick="{
  clearInterval(myClock)
  let myTemp = '100px 0px'
  myClock = setInterval(function(){
      myGlobalX -= 5
      myTemp =  myGlobalX + 'px 0px'
      document.getElementById('myBody').style.backgroundPosition = myTemp
  }, 100)}">
        
      <input type=button value="Right" onTouchStart="{this.click(); event.preventDefault();}" onclick="{
  document.getElementById('myImg01').style.left = parseInt(document.getElementById('myImg01').style.left) + 10 + 'px'
  myCheckHit()     // checks for all collisions
    }">
                
<input type=button value="Down" onTouchStart="{this.click(); event.preventDefault();}" onclick="{
  document.getElementById('myImg01').style.top = parseInt(document.getElementById('myImg01').style.top) + 10 + 'px'
  myCheckHit()     // checks for all collisions
    }">

    
<input type="button" value="shoot" onclick="{
  if (myShooting > 2) { myShooting = 1; }

  if (myShooting == 1) {
    myShooting += 1;
    document.getElementById('myBullet01').style.left = document.getElementById('myImg01').style.left;
    document.getElementById('myBullet01').style.top = document.getElementById('myImg01').style.top;

    clearInterval(myGun01);  // Stop any previous intervals
    myGun01 = setInterval(function() {
      document.getElementById('myBullet01').style.left = (parseInt(document.getElementById('myBullet01').style.left) + 10) + 'px';
      myCheckHit();  // Check for hits
    }, 20);  // Bullet speed
  }

  if (myShooting == 2) {
    myShooting += 1;
    document.getElementById('myBullet02').style.left = document.getElementById('myImg01').style.left;
    document.getElementById('myBullet02').style.top = document.getElementById('myImg01').style.top;

    clearInterval(myGun02);  // Stop any previous intervals
    myGun02 = setInterval(function() {
      document.getElementById('myBullet02').style.left = (parseInt(document.getElementById('myBullet02').style.left) + 10) + 'px';
      myCheckHit();  // Check for hits
    }, 20);  // Bullet speed
  }
}">
</div>


<img id="myImg01" src="https://piskel-imgstore-b.appspot.com/img/02210e61-c8be-11ef-a8ff-b92f8635db06.gif" style="position:absolute; width:100px; height:90px; left:350px; top:190px;">
<img id="myImg02" src="https://piskel-imgstore-b.appspot.com/img/0310e9a8-c8c3-11ef-8588-b92f8635db06.gif" style="display: none;">
<img id="myImg03" src="https://piskel-imgstore-b.appspot.com/img/0310e9a8-c8c3-11ef-8588-b92f8635db06.gif"  style="display: none;">
<img id="myImg04" src="https://piskel-imgstore-b.appspot.com/img/e8a98414-c8c3-11ef-8f6f-b92f8635db06.gif"  style="display: none;">


<img id="myBullet01" src="https://piskel-imgstore-b.appspot.com/img/7abcb900-cbcf-11ef-ae87-250a234cd9b6.gif"  style="position:absolute; width:100px; height:80px; left: 130px; top:190px;">
<img id="myBullet02" src="https://piskel-imgstore-b.appspot.com/img/7abcb900-cbcf-11ef-ae87-250a234cd9b6.gif"  style="position:absolute; width:100px; height:80px; left: 150px; top:190px;">


